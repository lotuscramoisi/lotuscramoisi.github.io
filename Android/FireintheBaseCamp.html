<!DOCTYPE html>
<html lang="en">
<link href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism-tomorrow.css" rel="stylesheet" />
<script src="../assets/js/prism.js"></script>
<script src="../assets/js/prism-java.min.js"></script>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CTF Writeup Template</title>
<style>
:root {
  --bg:#0e0f13; --fg:#e6e6e6; --muted:#9aa0a6;
  --accent:#7dd3fc; --edge:#3b4252; --node:#a78bfa;
  --badge:#1f2937; --highlight:#facc15;
  --color-code-background:#111318; --color-link:#7dd3fc;
  --highlight-foreground:#60a5fa; --highlight-nav:#7dd3fc33;
  --cursor-pointer:pointer;
}
.home-btn { text-decoration: none; color: var(--accent); background: var(--badge); padding: 6px 12px; border-radius: 6px; border: 1px solid var(--edge); font-weight: bold; transition: 0.3s; }
.home-btn:hover { background: var(--accent); color: var(--bg); }

body{margin:0;font-family:ui-sans-serif,system-ui;background:var(--bg);color:var(--fg)}
header{padding:16px;border-bottom:1px solid #1f2430;display:flex;align-items:center;justify-content:space-between;background:#111318}
h1{margin:0;font-size:24px}
.container{display:grid;grid-template-columns:1fr 360px;gap:16px;padding:16px}
aside{border-left:1px solid #1f2430;padding:16px;overflow-y:auto;background:#111318;box-shadow:-2px 0 8px rgba(0,0,0,0.3)}
.post{padding:12px;border:1px solid #232838;border-radius:10px;margin-bottom:12px;background:#181b22;box-shadow:0 2px 6px rgba(0,0,0,0.35)}
.post h4{margin:0 0 6px 0}.post .meta{font-size:12px;color:var(--muted);display:flex;gap:8px;flex-wrap:wrap}.badge{font-size:14px;background:var(--badge);padding:6px 10px;margin-right:10px;border-radius:6px;border:1px solid #2b3242}
.article-entry{margin-bottom:24px}
.article-entry code,.article-entry kbd{font-family:'JetBrains Mono','Menlo','Monaco','Consolas','monospace';font-size:95%;transition:0.3s;word-break:break-word;background:var(--color-code-background);padding:1px 5px;border-radius:5px;color:var(--color-link)}
.article-entry pre[class*="language-"]{ background: var(--color-code-background) !important; border-radius:0}
.article-entry pre code{background:none;text-shadow:none;color:var(--fg);padding:0}
.article-entry .highlight{overflow:hidden;interpolate-size:allow-keywords}
.article-entry .highlight.code-closed pre{height:0;opacity:0;overflow:hidden}
.code-area{width:100%;overflow:hidden;transition:0.3s;border-radius:10px;border:2px solid #232838;background:#111318;margin-bottom:16px}
.code-figcaption{width:100%;display:flex;justify-content:space-between;height:40px;align-items:center;flex-shrink:0;background:linear-gradient(to right, transparent 0%, var(--bg) 50%, transparent 100%);margin-bottom:10px;padding:0 8px;position:relative}
.code-left-wrap,.code-right-wrap{display:flex;align-items:center}
.code-copy,.code-lang,.code-expand{margin:5px; padding-right: 12px; z-index:1;filter:invert(50%);cursor:var(--cursor-pointer);color:#fff;transition:0.3s}
.code-copy:hover,.code-expand:hover{opacity:.7}
.code-expand{transform:rotate(0deg)}
.code-closed .code-expand{transform:rotate(-180deg)!important;transition:0.3s}
</style>
</head>
<body>
<header>
  <a href="../index.html" class="home-btn">Home</a>
  <h1>Fire in the Base Camp</h1>
  <div id="current-legend"><span class="badge">Mobile</span></div>
</header>
<div class="container">
  <main class="article-entry">
    <section>
      Challenge done during IRONCTF
      <h2>Introduction</h2>
      <p>The challenge began with an APK file that needed to be decompiled to retrieve key information hidden within the application. By using <code>apktool</code> to decompile the APK, we could explore the internal files and locate the Firebase URL hidden in the app's resources.</p>
    </section>
    <section>
      <h2>APK Decompilation</h2>
      <p>After decompiling the APK using the following command:</p>
      <div class="code-area">
        <div class="code-figcaption">
          <div class="code-left-wrap"><span class="code-lang">bash</span></div>
          <div class="code-right-wrap"><span class="code-copy">Copy</span></div>
        </div>
        <pre><code> apktool d Fire_in_the_Base_Camp.apk </code></pre>
      </div>
    </section>
    <section>
      <h2>Reconstructing Firebase URL</h2>
      <div class="code-area highlight">
        <div class="code-figcaption">
          <div class="code-left-wrap"><span class="code-lang">java</span></div>
          <div class="code-right-wrap"><span class="code-copy">Copy</span></div>
        </div>
        <pre><code class="language-java"> class HelloWorld {
    public static void main(String[] args) {
        // String.xml
        String fb1 = "/is/this/the/flag";
        String fb2 = "/i/think/this/is/the/one";
        String fb3 = "/seriously/give/me/the/flag/now";
        String fb4 = "/please/give/it/to/me";

        String path1 = fb4.substring(0, 7);    // "/please"
        String path2 = fb3.substring(10, 15);  // "give"
        String path3 = fb4.substring(18, 21);  // "it"
        String path4 = fb2.substring(16, 20);  // "this"
        String path5 = fb1.substring(12, 17);  // "flag"

        // Constructing the full path
        String completePath = path1 + path2 + path3 + path4 + path5; 

        // Base URL for Firebase
        String fburl = "https://app3-7d107-default-rtdb.firebaseio.com";

        String fullURL = fburl + completePath + ".json";

        System.out.println("Constructed Firebase URL: " + fullURL);
    }
}</code></pre>
      </div>
    </section>
    <section>
      <p>Once the url constructed has been called, it returns:</p>
      <div class="code-area">
        <div class="code-figcaption">
          <div class="code-left-wrap"><span class="code-lang">json</span></div>
          <div class="code-right-wrap"><span class="code-copy">Copy</span></div>
        </div>
        <pre><code> {
    "f1": "ironCTF{",
    "f2": "y0u_pu",
    "f3": "7_0u7_t",
    "f4": "h3_f1",
    "f5": "r3_1n_t",
    "f6": "h3_b4s",
    "f7": "3_c4mp",
    "f8": "_1f84a5",
    "f9": "c66ff5}"
 } </code></pre>
      </div>
    </section>
    <section>
      <p>The Firebase URL reconstruction allowed direct queries to retrieve challenge data efficiently.</p>
      <p>Combined all the element gives us the flag:</p>
      <pre><code>
ironCTF{y0u_pu7_0u7_th3_f1r3_1n_th3_b4s3_c4mp_1f84a5c66ff5}
              </code></pre>
    </section>
  </main>
  <aside>
    <h3>Related Writeups</h3>
    <div id="related-posts">
      <div class="post"><h4><a href="#" style="color:#60a5fa;text-decoration:none">Web Basics</a></h4><div class="meta"><span>2024-07-01</span><span class="badge" style="background:#60a5fa22;border-color:#60a5fa55">WEB</span></div></div>
      <div class="post"><h4><a href="#" style="color:#60a5fa;text-decoration:none">JWT None Attack</a></h4><div class="meta"><span>2024-10-01</span><span class="badge" style="background:#60a5fa22;border-color:#60a5fa55">WEB</span></div></div>
    </div>
  </aside>
</div>
</body>
</html>


<script>
document.querySelectorAll('.code-copy').forEach(btn => {
  btn.addEventListener('click', () => {
    const codeArea = btn.closest('.code-area');
    if (!codeArea) return;

    const codeBlock = codeArea.querySelector('pre code');
    if (!codeBlock) return;

    navigator.clipboard.writeText(codeBlock.innerText).then(() => {
      btn.textContent = 'Copied!';
      setTimeout(() => btn.textContent = 'Copy', 1500);
    }).catch(err => console.error('Failed to copy text: ', err));
  });
});
</script>
